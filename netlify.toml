# Netlify Configuration for Apex Truck Parking

[build]
  publish = "."
  functions = "netlify/functions"
  command = "npm install"

[build.environment]
  # Skip secrets scanning for intentionally public frontend keys
  SECRETS_SCAN_OMIT_KEYS = "SUPABASE_URL,SUPABASE_ANON_KEY"

[functions]
  node_bundler = "esbuild"
  included_files = ["node_modules/**"]

# Scheduled function - runs every 30 minutes for reminders
[functions."scheduled-reminders"]
  schedule = "*/30 * * * *"

# Redirect API calls to functions
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

# SEO Redirects - Match old Wix URL structure (301 permanent redirects)
[[redirects]]
  from = "/book-parking"
  to = "/book-parking.html"
  status = 301

[[redirects]]
  from = "/book-online"
  to = "/book-online.html"
  status = 301

[[redirects]]
  from = "/promotion"
  to = "/promotion.html"
  status = 301

[[redirects]]
  from = "/privacy-policy"
  to = "/privacy-policy.html"
  status = 301

[[redirects]]
  from = "/terms-of-service"
  to = "/terms-of-service.html"
  status = 301

[[redirects]]
  from = "/parking-confirmation"
  to = "/parking-confirmation.html"
  status = 301

[[redirects]]
  from = "/service-page/truck-trailer-parking"
  to = "/service-page/truck-trailer-parking.html"
  status = 301

# Environment variables (set these in Netlify Dashboard > Site Settings > Environment Variables)
# STRIPE_SECRET_KEY = sk_live_xxxxx
# STRIPE_WEBHOOK_SECRET = whsec_xxxxx
# SUPABASE_URL = https://xxxxx.supabase.co
# SUPABASE_ANON_KEY = xxxxx
# SUPABASE_SERVICE_KEY = xxxxx
# TWILIO_ACCOUNT_SID = your_account_sid
# TWILIO_AUTH_TOKEN = your_auth_token
# TWILIO_PHONE_NUMBER = +1xxxxxxxxxx
